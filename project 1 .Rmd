---
title: "Project 1"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
if (!require("UsingR")) install.packages("UsingR"); library(UsingR)
if (!require("cowplot")) install.packages("cowplot"); library(cowplot)
if (!require("tidyverse")) install.packages("tidyverse"); library(tidyverse)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
summary(cars)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

##Data Exploration

```{r}
ERdogs <- read_csv("ERdogs.csv")
head(ERdogs)
str(ERdogs)
ERdogs <- drop_na(ERdogs, 'Patient  Anxiety rating based on image above')
ERdogs <- drop_na(ERdogs, 'Patient  Pain rating based on image above')
ERdogs <- drop_na(ERdogs, 'Patient  Depression rating based on image above')
ERdogs <- drop_na(ERdogs, `Heart Rate`)
ERdogs.subset <- dplyr::select(ERdogs, 'Record ID', Age, Gender, Group, 'Patient  Anxiety rating based on image above', 'Patient  Pain rating based on image above', 'Patient  Depression rating based on image above')
head(ERdogs.subset)
summary(ERdogs.subset)
ERdogs.subset2 <- group_by(ERdogs.subset, Group)
summarize(ERdogs.subset2,'Patient  Anxiety rating based on image above',mean('Patient  Anxiety rating based on image above', na.rm = TRUE))

#Convert numeric to factor
ERdogs$`Patient  Anxiety rating based on image above`<- as.factor(ERdogs$`Patient  Anxiety rating based on image above`)
ERdogs$`Patient  Depression rating based on image above`<- as.factor(ERdogs$`Patient  Depression rating based on image above`)
ERdogs$`Patient  Pain rating based on image above`<- as.factor(ERdogs$`Patient  Pain rating based on image above`)
#Check to see that it converted 
str(ERdogs$`Patient  Anxiety rating based on image above`)
str(ERdogs$`Patient  Depression rating based on image above`)
str(ERdogs$`Patient  Pain rating based on image above`)
#Convert characters into numeric objects
ERdogs$`Heart Rate`<- as.numeric(ERdogs$`Heart Rate`)

```

##Data Visualization
   Visual representations of data are useful to illustrate general trends and relationships within the data set. Choosing which graph to make will depend on how many variables you are exploring and whether your variables are categorical or numerical. If using numerical variables, it is also important to consider whether the variable is discrete (only takes on specific values) or continuous (takes on any value). 
   
A bar graph provides the best representation of a single categorical variable or a single discrete numerical variable. 
```{r}
ggplot(ERdogs)+
   aes(x = `Patient  Anxiety rating based on image above`) +
geom_bar() +
  theme_cowplot()+
  xlab("Anxiety Rating") + 
  ylab("Number of Participants")

ggplot(ERdogs) +
  aes(x = `Patient  Depression rating based on image above`) +
  geom_bar() +
  theme_cowplot()+
  xlab("Depression Rating") + 
  ylab("Number of Participants")

ggplot(ERdogs) +
  aes(x = `Patient  Pain rating based on image above`) +
  geom_bar() +
  theme_cowplot()+
  xlab("Pain Rating") + 
  ylab("Number of Participants")

#xlab labels the x-axis
#ylab labels the y-axis
```

A grouped bar graph is the best representation when comparing two categorical variables.
```{r}

ggplot(ERdogs) +
  aes(x = `Patient  Pain rating based on image above`, color = Group, fill = Group) +
  geom_bar(binwidth = 0.5, position = "dodge") +
  theme_cowplot()

ggplot(ERdogs) +
  aes(x = `Patient  Anxiety rating based on image above`, color = Group, fill = Group) +
  geom_bar(binwidth = 0.5, position = "dodge") +
  theme_cowplot()

ggplot(ERdogs) +
  aes(x = `Patient  Depression rating based on image above`, color = Group, fill = Group) +
  geom_bar(binwidth = 0.5, position = "dodge") +
  theme_cowplot()
```

A Histogram provides the best representation of a single continuous numerical variable. 
```{r}
ggplot(ERdogs, aes(x=`Heart Rate`)) + 
  geom_histogram(color="black", fill="white") +
  theme_cowplot()+
  xlab("Heart Rate (BPM)")
```


A strip chart or box plot would be best to use when comparing a numerical variable with a categorical variable. 
```{r}
# Strip Chart
ggplot(ERdogs, aes(x = Group, y= `Heart Rate`, fill = Group)) +
  geom_jitter()+
   xlab("Group") + 
  ylab("Heart Rate")

#Box plot
ggplot(ERdogs) +
  aes(x = Group , y = `Heart Rate` , fill=Group) +
  geom_boxplot() +
geom_jitter(color="black", size=0.4, alpha=0.9)+
  theme_cowplot()+
   xlab("Group") + 
  ylab("Heart Rate")

#geom_jitter shows all the data points on each graph
```

##Hypothesis Testing 
Shapiro testing checks to see if the data is normally distributed. You can only perform shapiro testing for numerical values not categorical.
```{r}
shapiro.test(ERdogs$`Heart Rate`)
shapiro.test(ERdogs$`Heart Rate` [ERdogs$`Patient  Pain rating based on image above`])
shapiro.test(ERdogs$`Heart Rate` [ERdogs$`Patient  Depression rating based on image above`])
shapiro.test(ERdogs$`Heart Rate` [ERdogs$`Patient  Anxiety rating based on image above`])
##all heart rates are normally distributed (p-val<0.05) when separated into each category

```


One way anova testing used to compare categorical(Pain/Anxiety/Depression Rating) and numerical (Heart Rate) variables. 
```{r}
one.way <- aov(`Heart Rate`~`Patient  Pain rating based on image above` , data=ERdogs)
summary(one.way)
one.way <- aov(`Heart Rate`~`Patient  Anxiety rating based on image above` , data=ERdogs)
summary(one.way)
one.way <- aov(`Heart Rate`~`Patient  Depression rating based on image above` , data=ERdogs)
summary(one.way)

```


Chi Square testing is used to see if two categorical variables have significant correlation. Here, we are seeing if the patient ratings have any correlation with which group they are in (dog or no dog.)
```{r}
chisq.test(ERdogs.subset$`Patient  Depression rating based on image above`, ERdogs.subset$Group)
chisq.test(ERdogs.subset$`Patient  Anxiety rating based on image above`, ERdogs.subset$Group)
chisq.test(ERdogs.subset$`Patient  Pain rating based on image above`, ERdogs.subset$Group)
```


#Acknowledgements
https://data-flair.training/blogs/chi-square-test-in-r/
